
# 222.å®Œå…¨äºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°

é¢˜ç›®åœ°å€ï¼šhttps://leetcode-cn.com/problems/count-complete-tree-nodes/

ç»™å‡ºä¸€ä¸ªå®Œå…¨äºŒå‰æ ‘ï¼Œæ±‚å‡ºè¯¥æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°ã€‚

ç¤ºä¾‹:

<img src='../pics/222.å®Œå…¨äºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°.png' width=600> </img></div>

# æ€è·¯ 

æœ¬ç¯‡ç»™å‡ºæŒ‰ç…§æ™®é€šäºŒå‰æ ‘çš„æ±‚æ³•ä»¥åŠåˆ©ç”¨å®Œå…¨äºŒå‰æ ‘æ€§è´¨çš„æ±‚æ³•ã€‚

## æ™®é€šäºŒå‰æ ‘

é¦–å…ˆæŒ‰ç…§æ™®é€šäºŒå‰æ ‘çš„é€»è¾‘æ¥æ±‚ã€‚

è¿™é“é¢˜ç›®çš„é€’å½’æ³•å’Œæ±‚äºŒå‰æ ‘çš„æ·±åº¦å†™æ³•ç±»ä¼¼ï¼Œ è€Œè¿­ä»£æ³•ï¼Œ[äºŒå‰æ ‘ï¼šå±‚åºéå†ç™»åœºï¼](https://mp.weixin.qq.com/s/Gb3BjakIKGNpup2jYtTzog)éå†æ¨¡æ¿ç¨ç¨ä¿®æ”¹ä¸€ä¸‹ï¼Œè®°å½•éå†çš„èŠ‚ç‚¹æ•°é‡å°±å¯ä»¥äº†ã€‚

é€’å½’éå†çš„é¡ºåºä¾ç„¶æ˜¯ååºï¼ˆå·¦å³ä¸­ï¼‰ã€‚

### é€’å½’ 

å¦‚æœå¯¹æ±‚äºŒå‰æ ‘æ·±åº¦è¿˜ä¸ç†Ÿæ‚‰çš„è¯ï¼Œçœ‹è¿™ç¯‡ï¼š[äºŒå‰æ ‘ï¼šçœ‹çœ‹è¿™äº›æ ‘çš„æœ€å¤§æ·±åº¦](https://mp.weixin.qq.com/s/guKwV-gSNbA1CcbvkMtHBg)ã€‚

1. ç¡®å®šé€’å½’å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼ï¼šå‚æ•°å°±æ˜¯ä¼ å…¥æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œè¿”å›å°±è¿”å›ä»¥è¯¥èŠ‚ç‚¹ä¸ºæ ¹èŠ‚ç‚¹äºŒå‰æ ‘çš„èŠ‚ç‚¹æ•°é‡ï¼Œæ‰€ä»¥è¿”å›å€¼ä¸ºintç±»å‹ã€‚

ä»£ç å¦‚ä¸‹ï¼š
```
int getNodesNum(TreeNode* cur) {
```

2. ç¡®å®šç»ˆæ­¢æ¡ä»¶ï¼šå¦‚æœä¸ºç©ºèŠ‚ç‚¹çš„è¯ï¼Œå°±è¿”å›0ï¼Œè¡¨ç¤ºèŠ‚ç‚¹æ•°ä¸º0ã€‚

ä»£ç å¦‚ä¸‹ï¼š 

```
if (cur == NULL) return 0;
```

3. ç¡®å®šå•å±‚é€’å½’çš„é€»è¾‘ï¼šå…ˆæ±‚å®ƒçš„å·¦å­æ ‘çš„èŠ‚ç‚¹æ•°é‡ï¼Œå†æ±‚çš„å³å­æ ‘çš„èŠ‚ç‚¹æ•°é‡ï¼Œæœ€åå–æ€»å’Œå†åŠ ä¸€ ï¼ˆåŠ 1æ˜¯å› ä¸ºç®—ä¸Šå½“å‰ä¸­é—´èŠ‚ç‚¹ï¼‰å°±æ˜¯ç›®å‰èŠ‚ç‚¹ä¸ºæ ¹èŠ‚ç‚¹çš„èŠ‚ç‚¹æ•°é‡ã€‚

ä»£ç å¦‚ä¸‹ï¼š

```
int leftNum = getNodesNum(cur->left);      // å·¦
int rightNum = getNodesNum(cur->right);    // å³
int treeNum = leftNum + rightNum + 1;      // ä¸­
return treeNum;
```

æ‰€ä»¥æ•´ä½“C++ä»£ç å¦‚ä¸‹ï¼š

```
// ç‰ˆæœ¬ä¸€
class Solution {
private:
    int getNodesNum(TreeNode* cur) {
        if (cur == 0) return 0;
        int leftNum = getNodesNum(cur->left);      // å·¦
        int rightNum = getNodesNum(cur->right);    // å³
        int treeNum = leftNum + rightNum + 1;      // ä¸­
        return treeNum;
    }
public:
    int countNodes(TreeNode* root) {
        return getNodesNum(root);
    }
};
```

ä»£ç ç²¾ç®€ä¹‹åC++ä»£ç å¦‚ä¸‹ï¼š
```
// ç‰ˆæœ¬äºŒ
class Solution {
public:
    int countNodes(TreeNode* root) {
        if (root == NULL) return 0;
        return 1 + countNodes(root->left) + countNodes(root->right);
    }
};
```

æ—¶é—´å¤æ‚åº¦ï¼šO(n)   
ç©ºé—´å¤æ‚åº¦ï¼šO(logn)ï¼Œç®—ä¸Šäº†é€’å½’ç³»ç»Ÿæ ˆå ç”¨çš„ç©ºé—´

**ç½‘ä¸ŠåŸºæœ¬éƒ½æ˜¯è¿™ä¸ªç²¾ç®€çš„ä»£ç ç‰ˆæœ¬ï¼Œå…¶å®ä¸å»ºè®®å¤§å®¶ç…§ç€è¿™ä¸ªæ¥å†™ï¼Œä»£ç ç¡®å®ç²¾ç®€ï¼Œä½†éšè—äº†ä¸€äº›å†…å®¹ï¼Œè¿éå†çš„é¡ºåºéƒ½çœ‹ä¸å‡ºæ¥ï¼Œæ‰€ä»¥åˆå­¦è€…å»ºè®®å­¦ä¹ ç‰ˆæœ¬ä¸€çš„ä»£ç ï¼Œç¨³ç¨³çš„æ‰“åŸºç¡€**ã€‚


### è¿­ä»£æ³• 

å¦‚æœå¯¹æ±‚äºŒå‰æ ‘å±‚åºéå†è¿˜ä¸ç†Ÿæ‚‰çš„è¯ï¼Œçœ‹è¿™ç¯‡ï¼š[äºŒå‰æ ‘ï¼šå±‚åºéå†ç™»åœºï¼](https://mp.weixin.qq.com/s/Gb3BjakIKGNpup2jYtTzog)ã€‚

é‚£ä¹ˆåªè¦æ¨¡æ¿å°‘åšæ”¹åŠ¨ï¼ŒåŠ ä¸€ä¸ªå˜é‡resultï¼Œç»Ÿè®¡èŠ‚ç‚¹æ•°é‡å°±å¯ä»¥äº†

```
class Solution {
public:
    int countNodes(TreeNode* root) {
        queue<TreeNode*> que;
        if (root != NULL) que.push(root);
        int result = 0;
        while (!que.empty()) {
            int size = que.size();
            for (int i = 0; i < size; i++) {
                TreeNode* node = que.front();
                que.pop();
                result++;   // è®°å½•èŠ‚ç‚¹æ•°é‡
                if (node->left) que.push(node->left);
                if (node->right) que.push(node->right);
            }
        }
        return result;
    }
};
```
æ—¶é—´å¤æ‚åº¦ï¼šO(n)   
ç©ºé—´å¤æ‚åº¦ï¼šO(n)

## å®Œå…¨äºŒå‰æ ‘

ä»¥ä¸Šæ–¹æ³•éƒ½æ˜¯æŒ‰ç…§æ™®é€šäºŒå‰æ ‘æ¥åšçš„ï¼Œå¯¹äºå®Œå…¨äºŒå‰æ ‘ç‰¹æ€§ä¸äº†è§£çš„åŒå­¦å¯ä»¥çœ‹è¿™ç¯‡ [å…³äºäºŒå‰æ ‘ï¼Œä½ è¯¥äº†è§£è¿™äº›ï¼](https://mp.weixin.qq.com/s/_ymfWYvTNd2GvWvC5HOE4A)ï¼Œè¿™ç¯‡è¯¦ç»†ä»‹ç»äº†å„ç§äºŒå‰æ ‘çš„ç‰¹æ€§ã€‚

å®Œå…¨äºŒå‰æ ‘åªæœ‰ä¸¤ç§æƒ…å†µï¼Œæƒ…å†µä¸€ï¼šå°±æ˜¯æ»¡äºŒå‰æ ‘ï¼Œæƒ…å†µäºŒï¼šæœ€åä¸€å±‚å¶å­èŠ‚ç‚¹æ²¡æœ‰æ»¡ã€‚

å¯¹äºæƒ…å†µä¸€ï¼Œå¯ä»¥ç›´æ¥ç”¨ 2^æ ‘æ·±åº¦ - 1 æ¥è®¡ç®—ï¼Œæ³¨æ„è¿™é‡Œæ ¹èŠ‚ç‚¹æ·±åº¦ä¸º1ã€‚

å¯¹äºæƒ…å†µäºŒï¼Œåˆ†åˆ«é€’å½’å·¦å­©å­ï¼Œå’Œå³å­©å­ï¼Œé€’å½’åˆ°æŸä¸€æ·±åº¦ä¸€å®šä¼šæœ‰å·¦å­©å­æˆ–è€…å³å­©å­ä¸ºæ»¡äºŒå‰æ ‘ï¼Œç„¶åä¾ç„¶å¯ä»¥æŒ‰ç…§æƒ…å†µ1æ¥è®¡ç®—ã€‚

å®Œå…¨äºŒå‰æ ‘ï¼ˆä¸€ï¼‰å¦‚å›¾ï¼š
![222.å®Œå…¨äºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°](https://img-blog.csdnimg.cn/20201124092543662.png)

å®Œå…¨äºŒå‰æ ‘ï¼ˆäºŒï¼‰å¦‚å›¾ï¼š
![222.å®Œå…¨äºŒå‰æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°1](https://img-blog.csdnimg.cn/20201124092634138.png)

å¯ä»¥çœ‹å‡ºå¦‚æœæ•´ä¸ªæ ‘ä¸æ˜¯æ»¡äºŒå‰æ ‘ï¼Œå°±é€’å½’å…¶å·¦å³å­©å­ï¼Œç›´åˆ°é‡åˆ°æ»¡äºŒå‰æ ‘ä¸ºæ­¢ï¼Œç”¨å…¬å¼è®¡ç®—è¿™ä¸ªå­æ ‘ï¼ˆæ»¡äºŒå‰æ ‘ï¼‰çš„èŠ‚ç‚¹æ•°é‡ã€‚

C++ä»£ç å¦‚ä¸‹ï¼š

```C++
class Solution {
public:
    int countNodes(TreeNode* root) {
        if (root == nullptr) return 0;
        TreeNode* left = root->left;
        TreeNode* right = root->right;
        int leftHeight = 0, rightHeight = 0; // è¿™é‡Œåˆå§‹ä¸º0æ˜¯æœ‰ç›®çš„çš„ï¼Œä¸ºäº†ä¸‹é¢æ±‚æŒ‡æ•°æ–¹ä¾¿
        while (left) {  // æ±‚å·¦å­æ ‘æ·±åº¦
            left = left->left;
            leftHeight++;
        }
        while (right) { // æ±‚å³å­æ ‘æ·±åº¦
            right = right->right;
            rightHeight++;
        }
        if (leftHeight == rightHeight) {
            return (2 << leftHeight) - 1; // æ³¨æ„(2<<1) ç›¸å½“äº2^2ï¼Œæ‰€ä»¥leftHeightåˆå§‹ä¸º0
        }
        return countNodes(root->left) + countNodes(root->right) + 1;
    }
};
```

æ—¶é—´å¤æ‚åº¦ï¼šO(logn * logn)    
ç©ºé—´å¤æ‚åº¦ï¼šO(logn)   

> **æˆ‘æ˜¯[ç¨‹åºå‘˜Carl](https://github.com/youngyangyang04)ï¼Œå¯ä»¥æ‰¾æˆ‘[ç»„é˜Ÿåˆ·é¢˜](https://img-blog.csdnimg.cn/20201115103410182.png)ï¼Œä¹Ÿå¯ä»¥åœ¨[Bç«™ä¸Šæ‰¾åˆ°æˆ‘](https://space.bilibili.com/525438321)ï¼Œæœ¬æ–‡[leetcodeåˆ·é¢˜æ”»ç•¥](https://github.com/youngyangyang04/leetcode-master)å·²æ”¶å½•ï¼Œæ›´å¤š[ç²¾å½©ç®—æ³•æ–‡ç« ](https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzUxNjY5NTYxNA==&action=getalbum&album_id=1485825793120387074&scene=173#wechat_redirect)å°½åœ¨å…¬ä¼—å·ï¼š[ä»£ç éšæƒ³å½•](https://img-blog.csdnimg.cn/20200815195519696.png)ï¼Œå…³æ³¨åå°±ä¼šå‘ç°å’Œã€Œä»£ç éšæƒ³å½•ã€ç›¸è§æ¨æ™šï¼**

**å¦‚æœæ„Ÿè§‰å¯¹ä½ æœ‰å¸®åŠ©ï¼Œä¸è¦åå•¬ç»™ä¸€ä¸ªğŸ‘å§ï¼**

